<!-- PHOTO CARD (overlapping) -->

<section id="photo" class="card">
    <div>
        <div>
            <div class="grid grid-cols-1 lg:grid-cols-5">
                <!-- Image -->
                <div class="lg:col-span-3">
                    <div class="h-[360px] sm:h-[460px] lg:h-full bg-center bg-cover"
                        [style.backgroundImage]="'url(' + photoUrl + ')'" role="img"
                        aria-label="Photo of Kristin and Travis">
                    </div>
                </div>

                <!-- Text -->
                <div class="lg:col-span-2 relative p-8 sm:p-10 lg:p-12">
                    <p class="text-xs tracking-[0.28em] uppercase text-black/45">
                        A weekend we can‚Äôt wait to share
                    </p>

                    <h2 class="mt-4 font-serif text-3xl sm:text-4xl text-black/75">
                        We‚Äôre so happy you‚Äôre here
                    </h2>

                    <p class="mt-4 text-black/60 leading-relaxed">
                        We‚Äôre so excited to celebrate in Elk Ridge with the people we love most.
                        This site has everything you‚Äôll need for the weekend ‚Äî travel, places to stay, and a few fun
                        extras.
                    </p>

                    <div class="mt-8 flex flex-wrap gap-3">
                        <a routerLink="/accommodations" class="button-primary">
                            Where to stay
                        </a>

                        <a routerLink="/questions" class="button-secondary">
                            Q + A
                        </a>
                    </div>

                    <p class="mt-8 text-sm text-black/45">
                        Tip: bookmark this page ‚Äî we‚Äôll keep it updated.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="rsvp" class="card">
    <div class="">
        <div class="">
            <div class="p-8 sm:p-10 lg:p-12 text-center">
                <p class="text-xs tracking-[0.28em] uppercase text-black/40">
                    Please respond by {{ rsvp.deadline }}
                </p>

                <h2 class="mt-4 font-serif text-3xl sm:text-4xl text-black/75">
                    RSVP
                </h2>

                <p class="mt-4 max-w-xl mx-auto text-black/60 leading-relaxed">
                    Click below and it‚Äôll start your RSVP.
                </p>

                <div class="mt-8">
                    <div class="button-primary" (click)="openRsvp()">
                        RSVP ‚Üí
                    </div>
                </div>

                <p class="mt-6 text-black/60 ">
                    Or send an email to <a class="underline" href="mailTo:{{rsvp.email}}">{{rsvp.email}}</a>
                </p>

                <p class="mt-6 text-sm text-black/45">
                    Please include the names of everyone attending, and any allergies we should know about.
                </p>
            </div>
        </div>
    </div>
</section>


<section id="schedule" class="card">
    <div class="">
        <div class="">
            <div class="relative p-8 sm:p-10 lg:p-12">
                <!-- Header -->
                <p class="text-xs tracking-[0.28em] uppercase text-black/40">
                    The day at a glance
                </p>

                <h2 class="mt-4 font-serif text-3xl sm:text-4xl text-black/75">
                    Schedule
                </h2>

                <!-- Timeline -->
                <ol class="mt-10 space-y-6">
                    @for(item of schedule; track item.title) {
                    <li class="relative pl-14">
                        <!-- Dot -->
                        <span class="absolute left-[1.55rem] top-2 block h-3 w-3 rounded-full bg-[#D9A441]"></span>

                        <!-- Vertical line -->
                        @if(!$last) {
                        <span class="absolute left-[1.85rem] top-6 block h-full w-px bg-black/10"></span>
                        }


                        <!-- Content -->
                        <div class="flex flex-col sm:flex-row sm:items-baseline sm:gap-6">
                            <time class="font-medium text-black/70 sm:w-24 shrink-0">
                                {{ item.time }}
                            </time>

                            <p class="text-black/65">
                                {{ item.title }}
                            </p>
                        </div>
                    </li>
                    }

                </ol>

                <!-- Gentle note -->
                <p class="mt-10 text-sm text-black/45">
                    Timing may shift slightly ‚Äî we‚Äôll go with the flow.
                </p>
            </div>
        </div>
    </div>
</section>

<section id="gallery" class="card">
    <div class="">
        <div class="">

            <div class="relative p-8 sm:p-10 lg:p-12">
                <p class="text-xs tracking-[0.28em] uppercase text-black/40">
                    A few favorites
                </p>

                <div class="mt-4 flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4">
                    <h2 class="font-serif text-3xl sm:text-4xl text-black/75">Photos</h2>
                    <p class="text-sm text-black/45 max-w-md">
                        Some moments from along the way.
                    </p>
                </div>

                <!-- Grid -->
                <div class="mt-10 grid grid-cols-2 md:grid-cols-4 gap-4 sm:gap-5">
                    @for(img of gallery; track img.src) {
                    <figure class="group relative overflow-hidden rounded-2xl bg-black/5 ring-1 ring-black/5">
                        <button type="button" class="block w-full text-left" (click)="openLightbox($index)"
                            [attr.aria-label]="'Open photo ' + ($index + 1)">
                            <!-- Image -->
                            <img [src]="img.src" [alt]="img.alt" loading="lazy"
                                class="h-44 sm:h-56 w-full object-cover transition duration-300 group-hover:scale-[1.02]" />

                            <!-- Soft hover overlay -->
                            <div
                                class="pointer-events-none absolute inset-0 bg-black/0 group-hover:bg-black/10 transition">
                            </div>
                        </button>
                    </figure>
                    }
                </div>
            </div>
        </div>
    </div>
</section>

<section id="our-story" class="card">
    <div class="">
        <div class="">
            <div class="relative p-8 sm:p-10 lg:p-12">
                <p class="text-xs tracking-[0.28em] uppercase text-black/40">
                    {{ ourStory.eyebrow }}
                </p>

                <h2 class="mt-4 font-serif text-3xl sm:text-4xl text-black/75">
                    {{ ourStory.title }}
                </h2>

                <p class="mt-4 max-w-3xl text-black/60 leading-relaxed">
                    {{ ourStory.intro }}
                </p>

                <!-- Highlight blocks -->
                <div class="mt-10 grid grid-cols-1 lg:grid-cols-2 gap-6">
                    @for(h of ourStory.highlights; track h.body) {
                    <article class="card-item">
                        <h3 class="font-serif text-xl text-black/75">
                            {{ h.heading }}
                        </h3>
                        @for(b of h.body; track $index) {
                        <p class="mt-3 text-black/60 leading-relaxed">
                            {{ b }}
                        </p>
                        }

                    </article>
                    }

                </div>
            </div>
        </div>
    </div>
</section>

<!-- LIGHTBOX -->
@if(lightboxOpen()) {
<div class="fixed inset-0 z-[100] flex items-center justify-center" tabindex="0" (keydown)="onLightboxKeydown($event)"
    aria-modal="true" role="dialog">
    <!-- Backdrop -->
    <button type="button" class="absolute inset-0 bg-black/70" aria-label="Close lightbox"
        (click)="closeLightbox()"></button>

    <!-- Panel -->
    <div class="relative w-[92vw] max-w-5xl">
        <!-- Top controls -->
        <div class="absolute -top-12 right-0 flex items-center gap-2">
            <span class="text-white/80 text-sm">
                {{ lightboxIndex() + 1 }} / {{ gallery.length }}
            </span>

            <button type="button"
                class="rounded-full bg-white/15 px-4 py-2 text-sm text-white hover:bg-white/25 transition"
                (click)="closeLightbox()" aria-label="Close">
                Close ‚úï
            </button>
        </div>

        <!-- Image container -->
        <div
            class="relative overflow-hidden rounded-3xl bg-black/20 ring-1 ring-white/10 shadow-[0_30px_80px_-40px_rgba(0,0,0,0.8)]">
            <img [src]="gallery[lightboxIndex()].src" [alt]="gallery[lightboxIndex()].alt"
                class="max-h-[80vh] w-full object-contain bg-black/30" draggable="false" />

            <!-- Prev/Next buttons -->
            <button type="button"
                class="absolute left-3 top-1/2 -translate-y-1/2 rounded-full bg-white/15 p-3 text-white hover:bg-white/25 transition"
                (click)="prevImage()" aria-label="Previous image">
                ‚Äπ
            </button>

            <button type="button"
                class="absolute right-3 top-1/2 -translate-y-1/2 rounded-full bg-white/15 p-3 text-white hover:bg-white/25 transition"
                (click)="nextImage()" aria-label="Next image">
                ‚Ä∫
            </button>
        </div>

        <!-- Caption -->
        <p class="mt-4 text-center text-sm text-white/80">
            {{ gallery[lightboxIndex()].alt }}
        </p>

        <!-- Hint -->
        <p class="mt-2 text-center text-xs text-white/60">
            Use ‚Üê ‚Üí keys to navigate, ESC to close
        </p>
    </div>
</div>
}

<dialog #rsvpDialog class="rounded-3xl p-0 backdrop:bg-black/40">
    <form [formGroup]="form" (ngSubmit)="submitRsvp()" class="w-[92vw] max-w-lg">
        <div class="rounded-3xl bg-white p-6 sm:p-8 space-y-4">
            <h2 class="font-serif text-2xl text-black/75">
                RSVP
            </h2>

            @if(!submitted()) {
            <!-- Names -->
            <label class="block text-sm text-black/55">
                Names
                <textarea rows="2" formControlName="names" required
                    class="mt-2 w-full rounded-xl bg-white/80 ring-1 ring-black/10 px-4 py-3"
                    placeholder="e.g., Kristin & Travis"></textarea>
                <small>
                    Please enter at least one name.
                </small>
            </label>

            <!-- Attendance -->
            <fieldset class="block text-sm text-black/55">
                <legend class="pb-5">Will you be attending?</legend>
                <div class="flex flex-row flex-wrap">
                    <label
                        class="mt-2 cursor-pointer w-full rounded-xl ring-1 ring-black/10 px-4 py-3 mr-3"
                        [class]="{'bg-[#F7F1E7]': form.controls.attending.value, 'bg-white/80': !form.controls.attending.value}">
                        <input type="radio" formControlName="attending" [value]="true" />
                        Yes, can‚Äôt wait!
                    </label>

                    <label class="mt-2 cursor-pointer w-full rounded-xl bg-white/80 ring-1 ring-black/10 px-4 py-3"
                        [class]="{'bg-[#F7F1E7]': !form.controls.attending.value, 'bg-white/80': form.controls.attending.value}">
                        <input type="radio" formControlName="attending" [value]="false" />
                        No (we‚Äôll miss you)
                    </label>
                </div>

                <small class="block pt-4">
                    Please select an option.
                </small>
            </fieldset>

            <!-- Dietary -->
            <label class="block text-sm text-black/55">
                Dietary restrictions (optional)
                <textarea formControlName="dietaryRestrictions" rows="2"
                    class="mt-2 w-full rounded-xl bg-white/80 ring-1 ring-black/10 px-4 py-3"
                    placeholder="Vegetarian, gluten-free, allergies‚Ä¶"></textarea>
            </label>

            <!-- Comments -->
            <label class="block text-sm text-black/55">
                Comments (optional)
                <textarea formControlName="comments" rows="3"
                    class="mt-2 w-full rounded-xl bg-white/80 ring-1 ring-black/10 px-4 py-3"
                    placeholder="Anything you'd like us to know?"></textarea>
            </label>
            }
            @else {
            <h2
                class="bg-[#F7F1E7] flex font-serif justify-center mt-2 px-4 py-3 ring-1 ring-black/10 rounded-xl text-2xl text-black/75 w-full">
                Received ‚Äî thank you! üíõ
            </h2>

            }


            <!-- Actions -->
            <div class="flex justify-end gap-3 pt-4">
                @if(!submitted()) {
                <button type="button" class="rounded-full px-4 py-2 text-sm text-black/60 cursor-pointer"
                    (click)="closeRsvp()" [disabled]="submitting">
                    Cancel
                </button>



                <button type="submit" class="button-primary" [disabled]="form.invalid || submitting">
                    {{ submitting ? 'Sending‚Ä¶' : 'Submit RSVP' }}
                </button>
                }
                @else {
                <button class="button-primary" (click)="closeRsvp()">
                    Close
                </button>
                }
            </div>
            @if(status() && !submitted()) {
            <p class="status">{{ status() }}</p>
            }
        </div>


    </form>
</dialog>